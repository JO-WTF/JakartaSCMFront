<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DU 提交记录管理</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:0;background:#0b1020;color:#eaf2ff}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .card{background:#101831;border:1px solid #1f2a4d;border-radius:14px;padding:14px;margin-top:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:end}
    label{font-size:12px;color:#8aa2c8}
    input,select,textarea{background:#0e1631;color:#eaf2ff;border:1px solid #2a3a66;border-radius:10px;padding:8px 10px}
    input[type="date"]{min-width:180px}
    textarea{min-width:280px;min-height:80px}
    .btn{appearance:none;border:0;border-radius:999px;padding:10px 16px;font-weight:700;background:#69a8ff;color:#07122b;cursor:pointer}
    .ghost{background:#12182b;color:#eaf2ff}
    .danger{background:#ff6b6b;color:#07122b}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;border-bottom:1px solid #1f2a4d;text-align:left;font-size:14px;vertical-align:top}
    a{color:#69a8ff}
    .muted{color:#8aa2c8;font-size:12px}
    .pager{display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-top:8px}
    .actions{display:flex;gap:8px}
    .modal-mask{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:999}
    .modal{background:#0f1730;border:1px solid #283760;border-radius:14px;max-width:520px;width:92%;padding:14px}
    .modal h3{margin:0 0 8px 0}
    .modal .row>.field{flex:1;min-width:180px}
    .modal .foot{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
    .tag{display:inline-block;padding:2px 8px;border-radius:999px;background:#193057;font-size:12px}
  </style>
  <script>
    // 按需改为你的后端域名；注释掉则默认同源
    window.API_BASE = "https://jakartabackend.onrender.com";
  </script>
</head>
<body>
  <div class="container">
    <h2>DU 提交记录管理</h2>

    <!-- 批量查询（多个 DU） -->
    <div class="card">
      <div class="row">
        <div style="flex:1;min-width:320px">
          <label>批量 DU ID（可换行/逗号/空格分隔）</label><br>
          <textarea id="f-du-multi" placeholder="例如：&#10;DID123...&#10;DID456...&#10;或：DID123..., DID456..."></textarea>
        </div>
        <div class="field">
          <label>每页数量</label><br>
          <input id="f-ps" type="number" min="1" max="100" value="20" style="width:120px">
        </div>
        <div class="field">
          <button class="btn" id="btn-batch">批量查询</button>
        </div>
        <div class="field" style="flex:1"></div>
        <div class="field">
          <button class="btn ghost" id="btn-export-all">导出全部</button>
        </div>
        <div class="field">
          <button class="btn ghost" id="btn-trust-backend-link">点击去信任后台系统</button>
        </div>
      </div>
      <div class="muted" style="margin-top:6px">提示：批量查询会忽略下方的单个条件筛选。</div>
    </div>

    <!-- 条件筛选（单 DU / 条件） -->
    <div class="card">
      <div class="row">
        <div>
          <label>DU ID（单个）</label><br>
          <input id="f-du" placeholder="DID + 13位数字">
        </div>
        <div>
          <label>状态</label><br>
          <select id="f-status">
            <option value="">（全部）</option>
            <option value="运输中">运输中</option>
            <option value="过夜">过夜</option>
            <option value="已到达">已到达</option>
          </select>
        </div>
        <div>
          <label>备注关键词</label><br>
          <input id="f-remark" placeholder="模糊匹配">
        </div>
        <div>
          <label>是否带附件</label><br>
          <select id="f-has">
            <option value="">（不限）</option>
            <option value="true">有附件</option>
            <option value="false">无附件</option>
          </select>
        </div>
        <div>
          <label>开始日期</label><br>
          <input id="f-from" type="date">
        </div>
        <div>
          <label>结束日期</label><br>
          <input id="f-to" type="date">
        </div>
        <div>
          <label>每页数量</label><br>
          <input id="f-ps2" type="number" min="1" max="100" value="20" style="width:120px">
        </div>
        <div>
          <button class="btn" id="btn-search">查询</button>
          <button class="btn ghost" id="btn-reset">重置</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div id="hint" class="muted">输入条件后点击查询。</div>
      <table id="tbl" style="display:none">
        <thead>
          <tr>
            <th>ID</th><th>DU ID</th><th>状态</th><th>备注</th><th>照片</th><th>时间</th><th>操作</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="pager" id="pager" style="display:none">
        <button class="ghost" id="prev">上一页</button>
        <span id="pginfo" class="muted"></span>
        <button class="ghost" id="next">下一页</button>
      </div>
    </div>
  </div>

  <!-- 编辑弹窗 -->
  <div id="modal-mask" class="modal-mask">
    <div class="modal">
      <h3>编辑记录 <span id="modal-id" class="tag"></span></h3>
      <div class="row">
        <div class="field">
          <label>状态</label><br>
          <select id="m-status">
            <option value="">（不修改）</option>
            <option value="运输中">运输中</option>
            <option value="过夜">过夜</option>
            <option value="已到达">已到达</option>
          </select>
        </div>
        <div class="field" style="flex:1">
          <label>备注</label><br>
          <input id="m-remark" placeholder="不修改请留空">
        </div>
        <div class="field" style="flex:1">
          <label>替换照片（可选）</label><br>
          <input id="m-photo" type="file" accept="image/*">
        </div>
      </div>
      <div class="foot">
        <button class="btn ghost" id="m-cancel">取消</button>
        <button class="btn" id="m-save">保存</button>
      </div>
      <div class="muted" id="m-msg" style="margin-top:6px"></div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
